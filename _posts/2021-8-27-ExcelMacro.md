---
layout: page
title: 自分と異なる言語で作られたExcelブックは自分の環境でも開けるとは限らない
tags: [プログラミング]
---

タイトルの通りです。

# Context

複数人で複数ブック(複数ファイル)にまたがるシステムを開発していた。  
他人が作ったマクロ付きブックは自分以外のすべての人間が開くことができたが、自分だけ開くことができなかった(ブックが破損していると言われて、マクロがすべて削除された)。

# 原因

Excelは実はUTF-8などのモダンな文字コードを使っていない。  
日本語版のExcel(言語設定が日本語のExcel)であれば、Shift-JISを使うし、他の言語設定であれば他の文字コードが使われる。  
これはマクロ付きブック、及び、**マクロ自体**もそうで、マクロ内に日本語が一文字でも含まれていた場合、文字コードのデコードができず、ファイルが破損していると判定される。

解決策は簡単で、言語を多数派に合わせればいい。自分はこれでノートPCに入っているMS Officeの言語設定を英語から日本語に変更した。

# おわり

さすがに、UTF-8など、そういういい感じの文字コードになってると思うだろ。